var e=function(){return e=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},e.apply(this,arguments)};function t(e,t){void 0===t&&(t=!1);var r=window.crypto.getRandomValues(new Uint32Array(1))[0],n="_".concat(r);return Object.defineProperty(window,n,{value:function(r){return t&&Reflect.deleteProperty(window,n),null==e?void 0:e(r)},writable:!1,configurable:!0}),r}function r(r,n){return void 0===n&&(n={}),function(e,t,r,n){return new(r||(r=Promise))((function(o,a){function s(e){try{p(n.next(e))}catch(e){a(e)}}function i(e){try{p(n.throw(e))}catch(e){a(e)}}function p(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,i)}p((n=n.apply(e,t||[])).next())}))}(this,void 0,void 0,(function(){return function(e,t){var r,n,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function i(a){return function(i){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&a[0]?n.return:a[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){s.label=a[1];break}if(6===a[0]&&s.label<o[1]){s.label=o[1],o=a;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(a);break}o[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],n=0}finally{r=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,i])}}}(this,(function(o){return[2,new Promise((function(o,a){var s=t((function(e){o(e),Reflect.deleteProperty(window,"_".concat(i))}),!0),i=t((function(e){a(e),Reflect.deleteProperty(window,"_".concat(s))}),!0);window.__TAURI_IPC__(e({cmd:r,callback:s,error:i},n))}))]}))}))}function n(e){return"string"==typeof e?e:Array.from(e instanceof ArrayBuffer?new Uint8Array(e):e)}Object.freeze({__proto__:null,transformCallback:t,invoke:r,convertFileSrc:function(e,t){void 0===t&&(t="asset");var r=encodeURIComponent(e);return navigator.userAgent.includes("Windows")?"https://".concat(t,".localhost/").concat(r):"".concat(t,"://").concat(r)}});class o{constructor(e,t){this.type=e,this.payload=t}static generic(e,t){return new o("Generic",{vault:n(e),record:n(t)})}static counter(e,t){return new o("Counter",{vault:n(e),counter:t})}}class a{constructor(e,t){this.path=e,this.name=n(t)}getVault(e){return new i(this.path,this.name,n(e))}getStore(){return new s(this.path,this.name)}}class s{constructor(e,t){this.path=e,this.client=t}get(e){return r("plugin:stronghold|get_store_record",{snapshotPath:this.path,client:this.client,key:n(e)}).then((e=>Uint8Array.from(e)))}insert(e,t,o){return r("plugin:stronghold|save_store_record",{snapshotPath:this.path,client:this.client,key:n(e),value:t,lifetime:o})}remove(e){return r("plugin:stronghold|remove_store_record",{snapshotPath:this.path,client:this.client,key:n(e)}).then((e=>e?Uint8Array.from(e):null))}}class i extends class{constructor(e){this.procedureArgs=e}generateSLIP10Seed(e,t){return r("plugin:stronghold|execute_procedure",{...this.procedureArgs,procedure:{type:"SLIP10Generate",payload:{output:e,sizeBytes:t}}}).then((e=>Uint8Array.from(e)))}deriveSLIP10(e,t,n,o){return r("plugin:stronghold|execute_procedure",{...this.procedureArgs,procedure:{type:"SLIP10Derive",payload:{chain:e,input:{type:t,payload:n},output:o}}}).then((e=>Uint8Array.from(e)))}recoverBIP39(e,t,n){return r("plugin:stronghold|execute_procedure",{...this.procedureArgs,procedure:{type:"BIP39Recover",payload:{mnemonic:e,passphrase:n,output:t}}}).then((e=>Uint8Array.from(e)))}generateBIP39(e,t){return r("plugin:stronghold|execute_procedure",{...this.procedureArgs,procedure:{type:"BIP39Generate",payload:{output:e,passphrase:t}}}).then((e=>Uint8Array.from(e)))}getEd25519PublicKey(e){return r("plugin:stronghold|execute_procedure",{...this.procedureArgs,procedure:{type:"PublicKey",payload:{type:"Ed25519",privateKey:e}}}).then((e=>Uint8Array.from(e)))}signEd25519(e,t){return r("plugin:stronghold|execute_procedure",{...this.procedureArgs,procedure:{type:"Ed25519Sign",payload:{privateKey:e,msg:t}}}).then((e=>Uint8Array.from(e)))}}{constructor(e,t,r){super({snapshotPath:e,client:t,vault:r}),this.path=e,this.client=n(t),this.name=n(r)}insert(e,t){return r("plugin:stronghold|save_secret",{snapshotPath:this.path,client:this.client,vault:this.name,recordPath:n(e),secret:t})}remove(e){return r("plugin:stronghold|remove_secret",{snapshotPath:this.path,client:this.client,vault:this.name,location:e})}}class p{constructor(e){this.path=e}connect(e){return r("plugin:stronghold|p2p_connect",{snapshotPath:this.path,peer:e})}serve(){return r("plugin:stronghold|p2p_serve",{snapshotPath:this.path})}send(e,t,o){return r("plugin:stronghold|p2p_send",{snapshotPath:this.path,peer:e,client:n(t),request:o})}getSnapshotHierarchy(e,t){return this.send(e,t,{type:"SnapshotRequest",payload:{request:{type:"GetRemoteHierarchy"}}})}checkVault(e,t,r){return this.send(e,t,{type:"ClientRequest",payload:{request:{type:"CheckVault",payload:{vaultPath:r}}}})}checkRecord(e,t,r){return this.send(e,t,{type:"ClientRequest",payload:{request:{type:"CheckRecord",payload:{location:r}}}})}writeToVault(e,t,r,n){return this.send(e,t,{type:"ClientRequest",payload:{request:{type:"WriteToVault",payload:{location:r,payload:n}}}})}revokeData(e,t,r){return this.send(e,t,{type:"ClientRequest",payload:{request:{type:"RevokeData",payload:{location:r}}}})}deleteData(e,t,r){return this.send(e,t,{type:"ClientRequest",payload:{request:{type:"DeleteData",payload:{location:r}}}})}readFromStore(e,t,r){return this.send(e,t,{type:"ClientRequest",payload:{request:{type:"ReadFromStore",payload:{key:n(r)}}}})}writeToStore(e,t,r,o,a){return this.send(e,t,{type:"ClientRequest",payload:{request:{type:"WriteToStore",payload:{key:n(r),payload:o,lifetime:a}}}})}deleteFromStore(e,t,r){return this.send(e,t,{type:"ClientRequest",payload:{request:{type:"DeleteFromStore",payload:{key:n(r)}}}})}generateSLIP10Seed(e,t,r,n){return this.send(e,t,{type:"ClientRequest",payload:{request:{type:"Procedures",payload:{procedures:[{type:"SLIP10Generate",payload:{output:r,sizeBytes:n}}]}}}}).then((e=>Uint8Array.from(e)))}deriveSLIP10(e,t,r,n,o,a){return this.send(e,t,{type:"ClientRequest",payload:{request:{type:"Procedures",payload:{procedures:[{type:"SLIP10Derive",payload:{chain:r,input:{type:n,payload:o},output:a}}]}}}}).then((e=>Uint8Array.from(e)))}recoverBIP39(e,t,r,n,o){return this.send(e,t,{type:"ClientRequest",payload:{request:{type:"Procedures",payload:{procedures:[{type:"BIP39Recover",payload:{mnemonic:r,passphrase:o,output:n}}]}}}}).then((e=>Uint8Array.from(e)))}generateBIP39(e,t,r,n){return this.send(e,t,{type:"ClientRequest",payload:{request:{type:"Procedures",payload:{procedures:[{type:"BIP39Generate",payload:{output:r,passphrase:n}}]}}}}).then((e=>Uint8Array.from(e)))}getEd25519PublicKey(e,t,r){return this.send(e,t,{type:"ClientRequest",payload:{request:{type:"Procedures",payload:{procedures:[{type:"PublicKey",payload:{type:"Ed25519",privateKey:r}}]}}}}).then((e=>Uint8Array.from(e)))}signEd25519(e,t,r,n){return this.send(e,t,{type:"ClientRequest",payload:{request:{type:"Procedures",payload:{procedures:[{type:"Ed25519Sign",payload:{privateKey:r,msg:n}}]}}}}).then((e=>Uint8Array.from(e)))}stop(){return r("plugin:stronghold|p2p_stop",{snapshotPath:this.path})}startListening(e){return r("plugin:stronghold|p2p_start_listening",{snapshotPath:this.path,addr:e})}stopListening(){return r("plugin:stronghold|p2p_stop_listening",{snapshotPath:this.path})}addPeerAddr(e,t){return r("plugin:stronghold|p2p_add_peer",{snapshotPath:this.path,peerId:e,addr:t})}}class u{constructor(e,t){this.path=e,this.reload(t)}reload(e){return r("plugin:stronghold|initialize",{snapshotPath:this.path,password:e})}unload(){return r("plugin:stronghold|destroy",{snapshotPath:this.path})}loadClient(e){return r("plugin:stronghold|load_client",{snapshotPath:this.path,client:n(e)}).then((()=>new a(this.path,e)))}createClient(e){return r("plugin:stronghold|create_client",{snapshotPath:this.path,client:n(e)}).then((()=>new a(this.path,e)))}save(){return r("plugin:stronghold|save",{snapshotPath:this.path})}spawnCommunication(e,t,o){return r("plugin:stronghold|p2p_spawn",{snapshotPath:this.path,client:n(e),config:t,keypair:o}).then((()=>new p(this.path)))}}export{a as Client,p as Communication,o as Location,s as Store,u as Stronghold,i as Vault};
